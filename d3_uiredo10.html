<html>
<head>
  
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">

  <link href="https://fonts.googleapis.com/css?family=Titillium+Web" rel="stylesheet">

</head>


<body onload="rePaint()" onresize="rePaint()">

<style>

article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block;}audio,canvas,video{display:inline-block;}audio:not([controls]){display:none;height:0;}[hidden]{display:none;}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;}body{margin:0;}a:focus{outline:thin dotted;}a:active,a:hover{outline:0;}h1{font-size:2em;margin:0.67em 0;}abbr[title]{border-bottom:1px dotted;}b,strong{font-weight:bold;}dfn{font-style:italic;}hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0;}mark{background:#ff0;color:#000;}code,kbd,pre,samp{font-family:monospace,serif;font-size:1em;}pre{white-space:pre-wrap;}q{quotes:"\201C" "\201D" "\2018" "\2019";}small{font-size:80%;}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline;}sup{top:-0.5em;}sub{bottom:-0.25em;}img{border:0;}svg:not(:root){overflow:hidden;}figure{margin:0;}fieldset{border:1px solid #c0c0c0;margin:0 2px;padding:0.35em 0.625em 0.75em;}legend{border:0;padding:0;}button,input,select,textarea{font-family:inherit;font-size:100%;margin:0;}button,input{line-height:normal;}button,select{text-transform:none;}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer;}button[disabled],html input[disabled]{cursor:default;}input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0;}input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box;}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none;}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0;}textarea{overflow:auto;vertical-align:top;}table{border-collapse:collapse;border-spacing:0;}


@import url('https://fonts.googleapis.com/css?family=Titillium+Web');


/*These settings will go to all divs */
#rootDiv {
  box-sizing: border-box;  
  position:relative;
  top:0px;
  font-family: 'Titillium Web', Arial, sans-serif;
  font-weight: 300;
  font-size: 1.05em; 
  margin: 0;
  text-align:justify;
}

.baseDiv {
    border-color: #e3e3e3;
    border-style: solid;
    border-width: 1px;
    margin-left: -1px;
    margin-top: -1px;
    
  
}

i {
font-size: 1em;
  font-weight: 400;
  padding: 0 0 15px;
  line-height: 36px;
  
}

h1 {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);

  font-size: 28px;
  font-weight: 400;
  padding: 0 0 15px;
}  








</style>  

<!--Entire Document is mounted here -->
<div id="rootDiv"></div>


<script id="userNonPresentationData">
  //User Data Section. Keep things that will fetch user non-presentation data here
  //Do not put presentation elements here. Presentation elements will need rePainting when screens are resized. Put them in next script tag UserPresentationCode under function rePaintUserData() 






  function test(){
    console.log("test works");
    }
  test();



//This function will be called by framework for you
  function userDataNeedingNoRePaint(){

    function test(){
      console.log("test works inside userDataNeedingNoRePaint");
    }


    test();
    
    

  }

</script>

<script id="SystemConfiguration">
 
   var screenAlpha ={};
   screenAlpha.codeOrderDivList = [];
   screenAlpha.userDivSpan = {};
  //Main configuration for number of boxes in grid. You only have to define minimum width, minimum height and total number of boxes. Positioning will be taken care of by the code
  screenAlpha.boxMinimumWidth = 240;
  screenAlpha.boxMinimumHeight = 290;
  screenAlpha.totalBoxes = 50;
    
  //Turn them false when layout job is done
  screenAlpha.lastUserDivShouldCoverWholeLine  = true;
  screenAlpha.showBaseDivNumber = true  ;
  screenAlpha.showBaseDivBackground = true;
  screenAlpha.showLastOverLayDivBackground = true;
  
  //Styling Information for base Div grid, and overlay Div grid 
  screenAlpha.baseDivGridBackground = "white";
  screenAlpha.OverlayDivGridBackground =["pink"]
  screenAlpha.OverlayDivOpacity ="0.8";

  
</script>


<script id="UserPresentationCode">
/*
  
  1. You can create your own overlay divs, and put user HTML/Javascript code inside it. Give it space by calling createUserDiv(baseDivNumber,howManyAdjacentDivs,heightMultiplier)
  2. Keep static calculations outside rePainting zone in <script id="script_userNonPresentationData"> section
  3. Keep all the screen specific display in <script id="script_UserPresentationData"> zone
  4. All user presentation code should strictly be inside the function rePaintUserData()
*/

  function rePaintUserData(){
  //createUserDiv(baseDivNumber,howManyAdjacentDivs,heightMultiplier)
 /* 
  //Creates a user div which spans the entire line with id div_overlay_2 which be used to style and put content inside the div. Positioning has been taken care of
    createUserDiv(6,"full_line",1);

  //Creates a user div which spans 2 adjacent divs or end of line if those adjacent divs are could not be placed. The height is 3 row of divs. Div id is div_overlay_7
    createUserDiv(15,2,3);

   // You get last overly div ID for free if screenAlpha.lastUserDivShouldCoverWholeLine  = true; 
    if(screenAlpha.lastBaseDivNumber) document.getElementById("div_overlay_"+screenAlpha.lastBaseDivNumber).innerHTML="Last overlay DIV takes the whole row if configured that way";

 // You will get the height you request .. but not the width .. width will be clipped to available space

 */   
    screenAlpha.codeOrderDivList = [];

    var x0 = createUserDiv(0,3,2);
   // x0.style.backgroundColor = "#222";
    x0.innerHTML = `<h1>Ranchi Mall Base Template <i class="fab fa-bitcoin"></i></h1>`;

/*var x0 = createUserDiv(1);
var x0 = createUserDiv(2);
var x0 = createUserDiv(3);
var x0 = createUserDiv(4);
var x0 = createUserDiv(5);
*/

       function nextAvailableUserDivNumber(){
  
    
     var nextAvailableDivNumber;
     var boundaryLimit;
     var udiv1 = screenAlpha.codeOrderDivList[screenAlpha.codeOrderDivList.length-1];

     var n1 = screenAlpha.boxDetails.numberOfBoxesInRow;
     var h1 = screenAlpha["div_overlay_"+udiv1+"_howManyAdjacentDivs"]; if (h1=="full_line") {h1 = n1};
     var heightMultiplier = screenAlpha["div_overlay_"+udiv1+"_heightMultiplier"];
    
//Full Line Cases
     if ((h1 == "full_line") || ((udiv1 % n1) + h1 > n1-1) ){
      var current_k = Math.floor(udiv1/n1);
      var new_k = current_k + heightMultiplier;
      nextAvailableDivNumber = new_k*n1;
      }
//Non full line cases
    else
    {
    nextAvailableDivNumber = udiv1+h1;
    }  

//global processing
    //This rule is now deleting my previous legitimate div .. I need to fix this .. at least I know the problem
    //I am down to this delete logic .. how to delete .. done
    if (screenAlpha.previousDivNumber != nextAvailableDivNumber) {
       // debugger;
        if ((!screenAlpha.codeOrderDivList.includes(screenAlpha.previousDivNumber))){ deleteUserDiv(screenAlpha.previousDivNumber)};
        
        //if (udiv1 != screenAlpha.previousDivNumber){ deleteUserDiv(screenAlpha.previousDivNumber)};

       // deleteUserDiv(screenAlpha.previousDivNumber);
    }
    
  //Check if any of the previous guys have occupied a div. If yes, shift the div to the next vacant slot
    nextAvailableDivNumber = adjustForOverlap(nextAvailableDivNumber);

    screenAlpha.previousDivNumber = nextAvailableDivNumber;
    return nextAvailableDivNumber;
      
    }

  

  


     var x1 = createUserDiv(nextAvailableUserDivNumber(),4,2);
      x1.style.backgroundColor = "#678";
      x1.innerHTML = `<div style="text-align:justify;margin:20 auto;width:200px">Hello .. Checking this. what happens when I put a lot of text here. You see, I am getting really confused here. Are you not ?</div>`;




      var x2 = createUserDiv(nextAvailableUserDivNumber(),1,1);
      x2.style.backgroundColor = "#39b";
      x2.innerHTML = `<div style="text-align:justify;margin:20 auto;width:200px">Hello Viv </div>`;   
        


      var x3 = createUserDiv(nextAvailableUserDivNumber(),5,1);
      x3.style.backgroundColor = "#b9b";
      x3.innerHTML = `<div style="text-align:justify;margin:20 auto;width:200px">Hello Me </div>`;    

/* 
    var x3 = createUserDiv(3,1,1);
    var x3dimensions = getUserDivDimensions(3);
   // x3.style.backgroundColor="pink";
    x3.innerHTML = `<h1 style="height:${x3dimensions.height-100}px;overflow:hidden;">User Created HTML is working great</h1></p>`;

 */
       var x4 = createUserDiv(nextAvailableUserDivNumber(),2,2);
      x4.style.backgroundColor = "#99b";
      x4.innerHTML = `<div style="text-align:justify;margin:20 auto;width:200px">Pine Forest </div>`;  

             var x4 = createUserDiv(nextAvailableUserDivNumber(),3,1);
      x4.style.backgroundColor = "#f9b";
      x4.innerHTML = `<div style="text-align:justify;margin:20 auto;width:200px">Golf Course </div>`;  

  var x4 = createUserDiv(nextAvailableUserDivNumber(),2,1);
      x4.style.backgroundColor = "#123";
      x4.innerHTML = `<div style="text-align:justify;margin:20 auto;width:200px">Bison </div>`;  


    var x4 = createUserDiv(nextAvailableUserDivNumber(),4,1);
      x4.style.backgroundColor = "#323";
      x4.innerHTML = `<div style="text-align:justify;margin:20 auto;width:200px">Pink FLoyd </div>`;



//On repainting .. it creates that number again .. and updates getLastUserDivNumber ..
//screenAlpha.codeOrderDivList = [];

anotherDivCleanUp();
} // Main function end
</script>  

<script id="script_last">
//Positioning section 
//Keep this script tag section as the last tag

//Do not touch these settings
  screenAlpha.widthAdjustment = 18;
  screenAlpha.heightAdjustment = 20;
  screenAlpha.baseDivIdList = [];
  screenAlpha.userDivIdList = [];
  screenAlpha.lastBaseDivNumber = screenAlpha.totalBoxes -1;
  screenAlpha.lastUserDivNumber = 0;


//One time tasks not needing repainting
  oneTimeTasks();

  function oneTimeTasks(){
    createAllBaseDivs(screenAlpha.totalBoxes);
    userDataNeedingNoRePaint();
  }

  function createAllBaseDivs(totalBoxes){
      var index;
      for (index = 0; index < totalBoxes; index++) { 
      var divId = "div_"+index;
      createSingleBaseDiv(divId);
      screenAlpha.baseDivIdList.push(divId);
    }
  }

  function createSingleBaseDiv(divId){
   var divCreated = document.createElement("div");
   divCreated.id=divId;
   divCreated.style.position = "absolute";
   if(screenAlpha.showBaseDivBackground) {
      divCreated.classList.add("baseDiv");
      }
   rootDiv.appendChild(divCreated);
 }

//Tasks needing repainting
  function rePaint(){
    screenAlpha.boxDetails = boxesPerRowData(screenAlpha.boxMinimumWidth,screenAlpha.boxMinimumHeight);
    rootDivSetDimensions("rootDiv");
    positionTheBaseDivs();
    if(screenAlpha.lastUserDivShouldCoverWholeLine ) lastBaseDivOverlay();
    if(screenAlpha.showBaseDivBackground) {
      document.getElementById("rootDiv").style.backgroundColor = screenAlpha.baseDivGridBackground;
      }

    rePaintUserData();
    }

  function rootDivSetDimensions (rootElementId){
    var divSelected = document.getElementById(rootElementId);
    divSelected.style.width = (window.innerWidth-screenAlpha.widthAdjustment);
    divSelected.style.height = Math.ceil(screenAlpha.totalBoxes/screenAlpha.boxDetails.numberOfBoxesInRow)*screenAlpha.boxMinimumHeight;
    }

  function boxesPerRowData(boxMinimumWidth, boxMinimumHeight){
    var boxDetails = {};
    var numberOfBoxesInRow = Math.floor((window.innerWidth-screenAlpha.widthAdjustment)/boxMinimumWidth);
    var spillOverPerRow = (window.innerWidth-screenAlpha.widthAdjustment) - numberOfBoxesInRow*boxMinimumWidth;
    if (numberOfBoxesInRow == 0) {numberOfBoxesInRow = 1}; //to solve Divide by Zero problem
    var spillOverPerBox = spillOverPerRow/numberOfBoxesInRow;
    var boxEffectiveWidth = boxMinimumWidth + spillOverPerBox;
    boxDetails.numberOfBoxesInRow = numberOfBoxesInRow;
    boxDetails.boxEffectiveWidth = boxEffectiveWidth;
    screenAlpha.previousNumberOfBoxesInRow = screenAlpha.numberOfBoxesInRow;
    screenAlpha.numberOfBoxesInRow = numberOfBoxesInRow;
    screenAlpha.boxEffectiveWidth = boxEffectiveWidth;
    return boxDetails;
  }
 
 function topAndLeftPositionOfBaseDivs(divNumber){
    heightPositionMultiplier = Math.floor(divNumber/screenAlpha.boxDetails.numberOfBoxesInRow);
    widthPositionMultiplier = divNumber % screenAlpha.boxDetails.numberOfBoxesInRow;
    topPosition = screenAlpha.boxMinimumHeight*heightPositionMultiplier;
    leftPosition = screenAlpha.boxDetails.boxEffectiveWidth*widthPositionMultiplier;
    screenAlpha["div_"+divNumber+"_topPosition"] = topPosition;
    screenAlpha["div_"+divNumber+"_leftPosition"] = leftPosition;
  }

  function positionTheBaseDivs(){
    var index;
    for (index = 0; index < screenAlpha.baseDivIdList.length; index++) {
    topAndLeftPositionOfBaseDivs(index);
    var divId = "div_"+index;
    document.getElementById(divId).style.top=screenAlpha["div_"+index+"_topPosition"]+"px";
    document.getElementById(divId).style.left=screenAlpha["div_"+index+"_leftPosition"]+"px";
    document.getElementById(divId).style.width=screenAlpha.boxDetails.boxEffectiveWidth+"px";
    document.getElementById(divId).style.height = screenAlpha.boxMinimumHeight+"px"; 
    if(screenAlpha.showBaseDivNumber) document.getElementById(divId).innerHTML = index; 
      }
    }

   function createUserDiv(baseDivNumber,howManyAdjacentDivs=1,heightMultiplier=1){

      screenAlpha.codeOrderDivList.push(baseDivNumber);
      screenAlpha["div_overlay_"+baseDivNumber+"_howManyAdjacentDivs"]=howManyAdjacentDivs;
      screenAlpha["div_overlay_"+baseDivNumber+"_heightMultiplier"]=heightMultiplier;


     var topPosition = screenAlpha["div_"+baseDivNumber+"_topPosition"];
     if (howManyAdjacentDivs == "full_line") {
       var divWidth = screenAlpha.boxEffectiveWidth*screenAlpha.numberOfBoxesInRow;
       var leftPosition = "0";
       
       } 
     else
     {
       var originalLeftPosition = screenAlpha["div_"+baseDivNumber+"_leftPosition"];
       //Obtain the lowest width of 3 possibilities for overlay  
       var divWidth1 = screenAlpha.boxEffectiveWidth*screenAlpha.numberOfBoxesInRow;
       var divWidth2 = howManyAdjacentDivs*screenAlpha.boxEffectiveWidth;
       var divWidth3 = divWidth1 - screenAlpha["div_"+baseDivNumber+"_leftPosition"];
       var divWidthTemp = (divWidth1 > divWidth2) ? divWidth2 : divWidth1;
       var divWidth = (divWidthTemp > divWidth3) ? divWidth3 : divWidthTemp;
       
     }
     var divHeight = screenAlpha.boxMinimumHeight*heightMultiplier;
     var divId="div_overlay_"+baseDivNumber;

     screenAlpha[divId+"_lineDivCount"]=divWidth/screenAlpha.boxEffectiveWidth;
      var i;var j;
      var lineDivCount = screenAlpha[divId+"_lineDivCount"];
     screenAlpha.userDivSpan[baseDivNumber]=[];

      for(j=0;j<heightMultiplier;j++){
              for (i = 0; i < lineDivCount; i++) { 
              screenAlpha.userDivSpan[baseDivNumber].push(screenAlpha.numberOfBoxesInRow*j+baseDivNumber+i);
            }
      }
 
    if (!document.getElementById(divId)){
     var overlayDiv = document.createElement("div");
     overlayDiv.id=divId;
     overlayDiv.style.position = "absolute";
     document.getElementById("rootDiv").appendChild(overlayDiv)
    }
     var overlayDiv = document.getElementById(divId);
     overlayDiv.style.position = "absolute";overlayDiv.style.top = topPosition+"px";screenAlpha[divId+"_top"]=topPosition;
     if(howManyAdjacentDivs == "full_line") {screenAlpha[divId+"_left"]=0 } else {overlayDiv.style.left=originalLeftPosition+"px";screenAlpha[divId+"_left"]=originalLeftPosition};
     overlayDiv.style.width=divWidth+"px";screenAlpha[divId+"_width"]=divWidth;
     overlayDiv.style.height=divHeight+"px";screenAlpha[divId+"_height"]=divHeight;
     if(screenAlpha.showLastOverLayDivBackground) { 
      overlayDiv.style.backgroundColor=screenAlpha.OverlayDivGridBackground[baseDivNumber%screenAlpha.OverlayDivGridBackground.length];
      overlayDiv.style.opacity=screenAlpha.OverlayDivOpacity;
      if(screenAlpha.showBaseDivNumber) {
        overlayDiv.innerHTML="<span style='position:relative;left:20px'>Overlay Div Number "+baseDivNumber+"</span>";}
     }
     if(!screenAlpha.userDivIdList.includes(divId)) {
      screenAlpha.userDivIdList.push(divId);
      }
     

     return document.getElementById("div_overlay_"+baseDivNumber);
   }

   function getUserDivDimensions(userDivNumber){
     var x = {};
     x.height = screenAlpha["div_overlay_"+userDivNumber+"_height"];
     x.width = screenAlpha["div_overlay_"+userDivNumber+"_width"];
     x.top = screenAlpha["div_overlay_"+userDivNumber+"_top"];
     x.left = screenAlpha["div_overlay_"+userDivNumber+"_left"];
     return x;
    }

   function lastBaseDivOverlay(){
    //Last div will take over the whole line if the screenAlpha.lastUserDivShouldCoverWholeLine  configuration allows is
    var lastBaseDivNumber = screenAlpha.totalBoxes - 1 ;
    createUserDiv(lastBaseDivNumber,"full_line",1)
   } 

   function removeLargest(arr) {
     var min = Math.max.apply(null, arr);
     return arr.filter((e) => {return e != min});
    }


   function getLastUserDivNumber(){
     

     
      var extractNumbers = screenAlpha.userDivIdList.map(x => {return parseInt(x.replace("div_overlay_",""))});
      if (screenAlpha.lastUserDivShouldCoverWholeLine) extractNumbers = removeLargest(extractNumbers);
      if (typeof extractNumbers !== 'undefined' && extractNumbers.length > 0) { var highestValue = extractNumbers.reduce((a,b)=>{return a>b?a:b;});} else {highestValue = 0};
      
    // This condition is screwing me  
    //  if (highestValue >= screenAlpha.lastUserDivNumber) {return "All base divs are taken" } else {return highestValue+1};
     return highestValue;
   }


   function deleteUserDiv(divNumber){
    //check the code .. find original divs .. delete the other userDivs
   
if(typeof(divNumber) != 'undefined' && divNumber != null){

    delete screenAlpha["div_overlay_"+divNumber+"_height"]
    delete screenAlpha["div_overlay_"+divNumber+"_heightMultiplier"]
    delete screenAlpha["div_overlay_"+divNumber+"_howManyAdjacentDivs"]
    delete screenAlpha["div_overlay_"+divNumber+"_left"]
    delete screenAlpha["div_overlay_"+divNumber+"_top"]
    delete screenAlpha["div_overlay_"+divNumber+"_width"]

    delete screenAlpha.userDivSpan[divNumber];
    
    //remove div_overlay_divNumber from userDivIdList
   for( var i = 0; i < screenAlpha.userDivIdList.length; i++){ 
   if ( screenAlpha.userDivIdList[i] == "div_overlay_"+divNumber) {
     screenAlpha.userDivIdList.splice(i, 1); 
   }
  }

  var element = document.getElementById("div_overlay_"+divNumber);
   if(typeof(element) != 'undefined' && element != null){
        element.style="";
        element.innerHTML="";}
   
  }
}

function myFunction(item,index){
      if (!(screenAlpha.codeOrderDivList.includes(item))) {deleteUserDiv(item)};
    }

function anotherDivCleanUp(){
    var extractNumbers = screenAlpha.userDivIdList.map(x => {return parseInt(x.replace("div_overlay_",""))});
    if (screenAlpha.lastUserDivShouldCoverWholeLine) extractNumbers = removeLargest(extractNumbers);
    //Pick an element from extractNumbers. Check if it is included in screenAlpha.codeOrderDivList. If not, delete it
    extractNumbers.forEach(myFunction);

  }

 function adjustForOverlap(divNumber) {

      do
      {
      var overlap =0; 
      for (index = 0; index < screenAlpha.codeOrderDivList.length; index++) { 
        if(screenAlpha.userDivSpan[screenAlpha.codeOrderDivList[index]].includes(divNumber)){overlap=1 }; 
        }

        if(overlap == 1) {divNumber++;}
        }
    while (overlap !=0); //this condition has to be false to exit do while loop .. ie ovelap must be 0 .. until then keep on increasing nextAvailableDivNumber and check no overlap exists, If condition is true, repeat the loop.

    return divNumber;


 } 

 function forwardOverlap (baseDivNumber,howManyAdjacentDivs=1,heightMultiplier=1){

        
       var topPosition = screenAlpha["div_"+baseDivNumber+"_topPosition"];
     if (howManyAdjacentDivs == "full_line") {
       var divWidth = screenAlpha.boxEffectiveWidth*screenAlpha.numberOfBoxesInRow;
       var leftPosition = "0";
       
       } 
     else
     {
       var originalLeftPosition = screenAlpha["div_"+baseDivNumber+"_leftPosition"];
       //Obtain the lowest width of 3 possibilities for overlay  
       var divWidth1 = screenAlpha.boxEffectiveWidth*screenAlpha.numberOfBoxesInRow;
       var divWidth2 = howManyAdjacentDivs*screenAlpha.boxEffectiveWidth;
       var divWidth3 = divWidth1 - screenAlpha["div_"+baseDivNumber+"_leftPosition"];
       var divWidthTemp = (divWidth1 > divWidth2) ? divWidth2 : divWidth1;
       var divWidth = (divWidthTemp > divWidth3) ? divWidth3 : divWidthTemp;
       
     }
     var divHeight = screenAlpha.boxMinimumHeight*heightMultiplier;
     var divId="div_overlay_"+baseDivNumber;

     screenAlpha[divId+"_lineDivCount"]=divWidth/screenAlpha.boxEffectiveWidth;
      var i;var j;
      var lineDivCount = screenAlpha[divId+"_lineDivCount"];
     screenAlpha.userDivSpan[baseDivNumber]=[];

      for(j=0;j<heightMultiplier;j++){
              for (i = 0; i < lineDivCount; i++) { 
              screenAlpha.userDivSpan[baseDivNumber].push(screenAlpha.numberOfBoxesInRow*j+baseDivNumber+i);
            }
      }


 }

//End of positioning code
</script>

</body>
</html>
